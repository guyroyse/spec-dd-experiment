# Data Schema

This document describes the physical data schema for the Redis database.

## Key Patterns

| Entity  | Key Pattern           | Type      | Description                    |
|---------|----------------------|-----------|--------------------------------|
| User    | `user:{username}`    | JSON      | User account data              |
| Session | `session:{sessionId}`| JSON      | Session data with user reference|

## User

**Key:** `user:{username}` (lowercase username)

**Type:** JSON

**Fields:**

| Field          | Type   | Description                                      |
|----------------|--------|--------------------------------------------------|
| username       | string | The user's display username (original casing)    |
| passwordHash   | string | bcrypt hash of the user's password               |
| createdAt      | string | ISO 8601 timestamp of account creation           |

**Example:**
```json
{
  "username": "Alice",
  "passwordHash": "$2b$10$...",
  "createdAt": "2026-02-11T10:00:00.000Z"
}
```

## Session

**Key:** `session:{sessionId}` (UUID v4)

**Type:** JSON

**TTL:** 24 hours (86400 seconds)

**Fields:**

| Field     | Type   | Description                              |
|-----------|--------|------------------------------------------|
| username  | string | The username this session belongs to     |
| createdAt | string | ISO 8601 timestamp of session creation   |

**Example:**
```json
{
  "username": "alice",
  "createdAt": "2026-02-11T10:00:00.000Z"
}
```

## Conventions

### ID Generation
- Session IDs: UUID v4 generated by the backend

### Username Handling
- Usernames are stored with original casing in the user record
- User keys use lowercase username for case-insensitive lookup
- Session references use lowercase username

### Password Requirements
- Minimum 8 characters
- At least one lowercase letter
- At least one uppercase letter
- At least one number
- At least one symbol
- No spaces allowed

### Username Requirements
- Minimum 3 characters
- Maximum 24 characters
- Alphanumeric characters only (no spaces or symbols)

### Timestamps
- All timestamps are ISO 8601 format in UTC

### Session Management
- Sessions expire after 24 hours
- Session ID is stored in HTTP-only cookie named `sessionId`

